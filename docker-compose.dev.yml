# Режим разработки: admin-ui с автоперезагрузкой при изменении файлов.
# node_modules в контейнере — свои (Linux), иначе lightningcss и др. не найдут бинарники.
# Запуск: docker compose -f docker-compose.yml -f docker-compose.dev.yml up --build

services:
  admin-ui:
    image: manager-admin-ui-dev
    build:
      context: ./admin-ui
      dockerfile: Dockerfile.dev
    container_name: basketbot-admin-ui-dev
    restart: unless-stopped
    environment:
      NEXT_PUBLIC_API_URL: http://localhost:8095
      CHOKIDAR_USEPOLLING: "true"
      WATCHPACK_POLLING: "true"
    volumes:
      - ./admin-ui:/app
      # Свой node_modules в контейнере (Linux), не с хоста (Windows)
      - admin_ui_node_modules:/app/node_modules
    ports:
      - "3000:3000"
    depends_on:
      app:
        condition: service_healthy
    # Отключаем healthcheck в dev — контейнер жив, пока next dev запущен
    healthcheck:
      disable: true

volumes:
  admin_ui_node_modules:
